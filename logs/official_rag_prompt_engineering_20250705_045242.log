[04:52:42] üî• Setting up GPU configuration...
[04:52:42] üéØ Selected GPU 0: 79.3GB available
[04:52:42] üîß Using device: cuda:0
[04:52:42] üì¶ Loading Facebook RAG models...
[04:52:42] ü§ñ Model: facebook/rag-token-nq
[04:52:42]   Loading tokenizer...
[04:52:43] üîç Loading Wikipedia retriever...
[04:54:08] ‚úÖ Retriever loaded!
[04:54:08]   Loading RAG Token model...
[04:56:07] üöÄ RAG Token system ready!
[04:56:07] üìö Loading evaluation dataset...
[04:56:10] ‚úÖ SQuAD 2.0 loaded
[04:56:10]  Loaded 20 evaluation questions
[04:56:10] üß™ Starting production RAG experiment...
[04:56:10]  Experiment scope:
[04:56:10]    Questions: 20
[04:56:10]    Templates: 7
[04:56:10]    Total evaluations: 140
[04:56:10] 
üîÑ Testing template: instructional
[04:56:10] Generating answer for template: instructional
[04:56:10] Using prompt: Answer the following question using available information: In what country is Normandy located?
[04:56:10] Input prepared: torch.Size([1, 17])
[04:56:11] RAG generated: ' france' for instructional
[04:56:11] Generating answer for template: instructional
[04:56:11] Using prompt: Answer the following question using available information: When were the Normans in Normandy?
[04:56:11] Input prepared: torch.Size([1, 18])
[04:56:11] RAG generated: ' 10th century -- 15th century' for instructional
[04:56:11] Generating answer for template: instructional
[04:56:11] Using prompt: Answer the following question using available information: From which countries did the Norse originate?
[04:56:11] Input prepared: torch.Size([1, 18])
[04:56:11] RAG generated: ' iceland' for instructional
[04:56:11] Generating answer for template: instructional
[04:56:11] Using prompt: Answer the following question using available information: Who was the Norse leader?
[04:56:11] Input prepared: torch.Size([1, 16])
[04:56:11] RAG generated: ' whoopi goldberg' for instructional
[04:56:11] Generating answer for template: instructional
[04:56:11] Using prompt: Answer the following question using available information: What century did the Normans first gain their separate identity?
[04:56:11] Input prepared: torch.Size([1, 22])
[04:56:12] RAG generated: ' the ninth century' for instructional
[04:56:12]   Progress: 5/140 (3.6%)
[04:56:12] Generating answer for template: instructional
[04:56:12] Using prompt: Answer the following question using available information: Who was the duke in the battle of Hastings?
[04:56:12] Input prepared: torch.Size([1, 20])
[04:56:12] RAG generated: ' normandy duke of normandy' for instructional
[04:56:12] Generating answer for template: instructional
[04:56:12] Using prompt: Answer the following question using available information: Who ruled the duchy of Normandy
[04:56:12] Input prepared: torch.Size([1, 16])
[04:56:12] RAG generated: ' king charles iii' for instructional
[04:56:12] Generating answer for template: instructional
[04:56:12] Using prompt: Answer the following question using available information: What religion were the Normans
[04:56:12] Input prepared: torch.Size([1, 16])
[04:56:12] RAG generated: ' islam' for instructional
[04:56:12] Generating answer for template: instructional
[04:56:12] Using prompt: Answer the following question using available information: What is the original meaning of the word Norman?
[04:56:12] Input prepared: torch.Size([1, 20])
[04:56:12] RAG generated: ' norman' for instructional
[04:56:12] Generating answer for template: instructional
[04:56:12] Using prompt: Answer the following question using available information: When was the Latin version of the word Norman first recorded?
[04:56:12] Input prepared: torch.Size([1, 22])
[04:56:12] RAG generated: ' the 6th century ad' for instructional
[04:56:12]   Progress: 10/140 (7.1%)
[04:56:12] Generating answer for template: instructional
[04:56:12] Using prompt: Answer the following question using available information: When was the Duchy of Normandy founded?
[04:56:12] Input prepared: torch.Size([1, 18])
[04:56:12] RAG generated: ' 1066' for instructional
[04:56:12] Generating answer for template: instructional
[04:56:12] Using prompt: Answer the following question using available information: Who did Rollo sign the treaty of Saint-Clair-sur-Epte with?
[04:56:12] Input prepared: torch.Size([1, 28])
[04:56:13] RAG generated: ' the franks' for instructional
[04:56:13] Generating answer for template: instructional
[04:56:13] Using prompt: Answer the following question using available information: What river originally bounded the Duchy
[04:56:13] Input prepared: torch.Size([1, 16])
[04:56:13] RAG generated: ' rhode island' for instructional
[04:56:13] Generating answer for template: instructional
[04:56:13] Using prompt: Answer the following question using available information: Who upon arriving gave the original viking settlers a common identity?
[04:56:13] Input prepared: torch.Size([1, 22])
[04:56:13] RAG generated: ' the Normans' for instructional
[04:56:13] Generating answer for template: instructional
[04:56:13] Using prompt: Answer the following question using available information: What was the Norman religion?
[04:56:13] Input prepared: torch.Size([1, 16])
[04:56:13] RAG generated: ' christianity' for instructional
[04:56:13]   Progress: 15/140 (10.7%)
[04:56:13] Generating answer for template: instructional
[04:56:13] Using prompt: Answer the following question using available information: What part of France were the Normans located?
[04:56:13] Input prepared: torch.Size([1, 20])
[04:56:13] RAG generated: ' what is now france' for instructional
[04:56:13] Generating answer for template: instructional
[04:56:13] Using prompt: Answer the following question using available information: What was one of the Norman's major exports?
[04:56:13] Input prepared: torch.Size([1, 21])
[04:56:13] RAG generated: ' 266,827' for instructional
[04:56:13] Generating answer for template: instructional
[04:56:13] Using prompt: Answer the following question using available information: Who was the Normans' main enemy in Italy, the Byzantine Empire and Armenia?
[04:56:13] Input prepared: torch.Size([1, 27])
[04:56:14] RAG generated: ' byzantine empire' for instructional
[04:56:14] Generating answer for template: instructional
[04:56:14] Using prompt: Answer the following question using available information: When did Herve serve as a Byzantine general?
[04:56:14] Input prepared: torch.Size([1, 20])
[04:56:14] RAG generated: ' during the byzantine war' for instructional
[04:56:14] Generating answer for template: instructional
[04:56:14] Using prompt: Answer the following question using available information: When did Robert Crispin go up against the Turks?
[04:56:14] Input prepared: torch.Size([1, 21])
[04:56:14] RAG generated: ' 1998' for instructional
[04:56:14]   Progress: 20/140 (14.3%)
[04:56:14]    instructional summary: F1=0.119, EM=0.050
[04:56:14] 
üîÑ Testing template: expert_role
[04:56:14] Generating answer for template: expert_role
[04:56:14] Using prompt: As an expert, provide a precise answer: In what country is Normandy located?
[04:56:14] Input prepared: torch.Size([1, 18])
[04:56:14] RAG generated: ' france' for expert_role
[04:56:14] Generating answer for template: expert_role
[04:56:14] Using prompt: As an expert, provide a precise answer: When were the Normans in Normandy?
[04:56:14] Input prepared: torch.Size([1, 19])
[04:56:14] RAG generated: ' 3rd century bc' for expert_role
[04:56:14] Generating answer for template: expert_role
[04:56:14] Using prompt: As an expert, provide a precise answer: From which countries did the Norse originate?
[04:56:14] Input prepared: torch.Size([1, 19])
[04:56:14] RAG generated: ' iceland' for expert_role
[04:56:14] Generating answer for template: expert_role
[04:56:14] Using prompt: As an expert, provide a precise answer: Who was the Norse leader?
[04:56:14] Input prepared: torch.Size([1, 17])
[04:56:15] RAG generated: ' norse' for expert_role
[04:56:15] Generating answer for template: expert_role
[04:56:15] Using prompt: As an expert, provide a precise answer: What century did the Normans first gain their separate identity?
[04:56:15] Input prepared: torch.Size([1, 23])
[04:56:15] RAG generated: ' 1876' for expert_role
[04:56:15]   Progress: 25/140 (17.9%)
[04:56:15] Generating answer for template: expert_role
[04:56:15] Using prompt: As an expert, provide a precise answer: Who was the duke in the battle of Hastings?
[04:56:15] Input prepared: torch.Size([1, 21])
[04:56:15] RAG generated: ' duke of normandy' for expert_role
[04:56:15] Generating answer for template: expert_role
[04:56:15] Using prompt: As an expert, provide a precise answer: Who ruled the duchy of Normandy
[04:56:15] Input prepared: torch.Size([1, 17])
[04:56:15] RAG generated: ' who ruled the duchy of normandy' for expert_role
[04:56:15] Generating answer for template: expert_role
[04:56:15] Using prompt: As an expert, provide a precise answer: What religion were the Normans
[04:56:15] Input prepared: torch.Size([1, 17])
[04:56:15] RAG generated: ' normans' for expert_role
[04:56:15] Generating answer for template: expert_role
[04:56:15] Using prompt: As an expert, provide a precise answer: What is the original meaning of the word Norman?
[04:56:15] Input prepared: torch.Size([1, 21])
[04:56:15] RAG generated: ' norman' for expert_role
[04:56:15] Generating answer for template: expert_role
[04:56:15] Using prompt: As an expert, provide a precise answer: When was the Latin version of the word Norman first recorded?
[04:56:15] Input prepared: torch.Size([1, 23])
[04:56:15] RAG generated: ' 2018' for expert_role
[04:56:15]   Progress: 30/140 (21.4%)
[04:56:15] Generating answer for template: expert_role
[04:56:15] Using prompt: As an expert, provide a precise answer: When was the Duchy of Normandy founded?
[04:56:15] Input prepared: torch.Size([1, 19])
[04:56:16] RAG generated: ' 973' for expert_role
[04:56:16] Generating answer for template: expert_role
[04:56:16] Using prompt: As an expert, provide a precise answer: Who did Rollo sign the treaty of Saint-Clair-sur-Epte with?
[04:56:16] Input prepared: torch.Size([1, 29])
[04:56:16] RAG generated: '' for expert_role
[04:56:16] Generating answer for template: expert_role
[04:56:16] Using prompt: As an expert, provide a precise answer: What river originally bounded the Duchy
[04:56:16] Input prepared: torch.Size([1, 17])
[04:56:16] RAG generated: ' archimedes' for expert_role
[04:56:16] Generating answer for template: expert_role
[04:56:16] Using prompt: As an expert, provide a precise answer: Who upon arriving gave the original viking settlers a common identity?
[04:56:16] Input prepared: torch.Size([1, 23])
[04:56:16] RAG generated: ' dr. marcel - j√©r√¥me rigollot' for expert_role
[04:56:16] Generating answer for template: expert_role
[04:56:16] Using prompt: As an expert, provide a precise answer: What was the Norman religion?
[04:56:16] Input prepared: torch.Size([1, 17])
[04:56:16] RAG generated: ' islam' for expert_role
[04:56:16]   Progress: 35/140 (25.0%)
[04:56:16] Generating answer for template: expert_role
[04:56:16] Using prompt: As an expert, provide a precise answer: What part of France were the Normans located?
[04:56:16] Input prepared: torch.Size([1, 21])
[04:56:16] RAG generated: ' what is now france' for expert_role
[04:56:16] Generating answer for template: expert_role
[04:56:16] Using prompt: As an expert, provide a precise answer: What was one of the Norman's major exports?
[04:56:16] Input prepared: torch.Size([1, 22])
[04:56:17] RAG generated: ' cloth' for expert_role
[04:56:17] Generating answer for template: expert_role
[04:56:17] Using prompt: As an expert, provide a precise answer: Who was the Normans' main enemy in Italy, the Byzantine Empire and Armenia?
[04:56:17] Input prepared: torch.Size([1, 28])
[04:56:17] RAG generated: ' canada' for expert_role
[04:56:17] Generating answer for template: expert_role
[04:56:17] Using prompt: As an expert, provide a precise answer: When did Herve serve as a Byzantine general?
[04:56:17] Input prepared: torch.Size([1, 21])
[04:56:17] RAG generated: ' 2004 -- 05' for expert_role
[04:56:17] Generating answer for template: expert_role
[04:56:17] Using prompt: As an expert, provide a precise answer: When did Robert Crispin go up against the Turks?
[04:56:17] Input prepared: torch.Size([1, 22])
[04:56:17] RAG generated: ' robert crispin' for expert_role
[04:56:17]   Progress: 40/140 (28.6%)
[04:56:17]    expert_role summary: F1=0.070, EM=0.050
[04:56:17] 
üîÑ Testing template: precise_instruction
[04:56:17] Generating answer for template: precise_instruction
[04:56:17] Using prompt: Give a factual, concise answer to: In what country is Normandy located?
[04:56:17] Input prepared: torch.Size([1, 18])
[04:56:17] RAG generated: ' france' for precise_instruction
[04:56:17] Generating answer for template: precise_instruction
[04:56:17] Using prompt: Give a factual, concise answer to: When were the Normans in Normandy?
[04:56:17] Input prepared: torch.Size([1, 19])
[04:56:17] RAG generated: ' between the 10th and 13th centuries' for precise_instruction
[04:56:17] Generating answer for template: precise_instruction
[04:56:17] Using prompt: Give a factual, concise answer to: From which countries did the Norse originate?
[04:56:17] Input prepared: torch.Size([1, 19])
[04:56:18] RAG generated: ' scandinavia' for precise_instruction
[04:56:18] Generating answer for template: precise_instruction
[04:56:18] Using prompt: Give a factual, concise answer to: Who was the Norse leader?
[04:56:18] Input prepared: torch.Size([1, 17])
[04:56:18] RAG generated: ' norse' for precise_instruction
[04:56:18] Generating answer for template: precise_instruction
[04:56:18] Using prompt: Give a factual, concise answer to: What century did the Normans first gain their separate identity?
[04:56:18] Input prepared: torch.Size([1, 23])
[04:56:18] RAG generated: ' the 17th century' for precise_instruction
[04:56:18]   Progress: 45/140 (32.1%)
[04:56:18] Generating answer for template: precise_instruction
[04:56:18] Using prompt: Give a factual, concise answer to: Who was the duke in the battle of Hastings?
[04:56:18] Input prepared: torch.Size([1, 21])
[04:56:18] RAG generated: ' normandy duke of normandy' for precise_instruction
[04:56:18] Generating answer for template: precise_instruction
[04:56:18] Using prompt: Give a factual, concise answer to: Who ruled the duchy of Normandy
[04:56:18] Input prepared: torch.Size([1, 17])
[04:56:18] RAG generated: ' king charles iii' for precise_instruction
[04:56:18] Generating answer for template: precise_instruction
[04:56:18] Using prompt: Give a factual, concise answer to: What religion were the Normans
[04:56:18] Input prepared: torch.Size([1, 17])
[04:56:18] RAG generated: ' catholicism' for precise_instruction
[04:56:18] Generating answer for template: precise_instruction
[04:56:18] Using prompt: Give a factual, concise answer to: What is the original meaning of the word Norman?
[04:56:18] Input prepared: torch.Size([1, 21])
[04:56:19] RAG generated: ' `` normal ''' for precise_instruction
[04:56:19] Generating answer for template: precise_instruction
[04:56:19] Using prompt: Give a factual, concise answer to: When was the Latin version of the word Norman first recorded?
[04:56:19] Input prepared: torch.Size([1, 23])
[04:56:19] RAG generated: ' in 1024' for precise_instruction
[04:56:19]   Progress: 50/140 (35.7%)
[04:56:19] Generating answer for template: precise_instruction
[04:56:19] Using prompt: Give a factual, concise answer to: When was the Duchy of Normandy founded?
[04:56:19] Input prepared: torch.Size([1, 19])
[04:56:19] RAG generated: ' 1066' for precise_instruction
[04:56:19] Generating answer for template: precise_instruction
[04:56:19] Using prompt: Give a factual, concise answer to: Who did Rollo sign the treaty of Saint-Clair-sur-Epte with?
[04:56:19] Input prepared: torch.Size([1, 29])
[04:56:19] RAG generated: ' charles' for precise_instruction
[04:56:19] Generating answer for template: precise_instruction
[04:56:19] Using prompt: Give a factual, concise answer to: What river originally bounded the Duchy
[04:56:19] Input prepared: torch.Size([1, 17])
[04:56:19] RAG generated: ' mississippi river' for precise_instruction
[04:56:19] Generating answer for template: precise_instruction
[04:56:19] Using prompt: Give a factual, concise answer to: Who upon arriving gave the original viking settlers a common identity?
[04:56:19] Input prepared: torch.Size([1, 23])
[04:56:19] RAG generated: ' the' for precise_instruction
[04:56:19] Generating answer for template: precise_instruction
[04:56:19] Using prompt: Give a factual, concise answer to: What was the Norman religion?
[04:56:19] Input prepared: torch.Size([1, 17])
[04:56:19] RAG generated: ' islam' for precise_instruction
[04:56:19]   Progress: 55/140 (39.3%)
[04:56:19] Generating answer for template: precise_instruction
[04:56:19] Using prompt: Give a factual, concise answer to: What part of France were the Normans located?
[04:56:19] Input prepared: torch.Size([1, 21])
[04:56:20] RAG generated: ' normandy' for precise_instruction
[04:56:20] Generating answer for template: precise_instruction
[04:56:20] Using prompt: Give a factual, concise answer to: What was one of the Norman's major exports?
[04:56:20] Input prepared: torch.Size([1, 22])
[04:56:20] RAG generated: ' petroleum' for precise_instruction
[04:56:20] Generating answer for template: precise_instruction
[04:56:20] Using prompt: Give a factual, concise answer to: Who was the Normans' main enemy in Italy, the Byzantine Empire and Armenia?
[04:56:20] Input prepared: torch.Size([1, 28])
[04:56:20] RAG generated: ' the seljuk turks' for precise_instruction
[04:56:20] Generating answer for template: precise_instruction
[04:56:20] Using prompt: Give a factual, concise answer to: When did Herve serve as a Byzantine general?
[04:56:20] Input prepared: torch.Size([1, 21])
[04:56:20] RAG generated: ' 1984 -- 86' for precise_instruction
[04:56:20] Generating answer for template: precise_instruction
[04:56:20] Using prompt: Give a factual, concise answer to: When did Robert Crispin go up against the Turks?
[04:56:20] Input prepared: torch.Size([1, 22])
[04:56:20] RAG generated: ' the battle of thermopylae' for precise_instruction
[04:56:20]   Progress: 60/140 (42.9%)
[04:56:20]    precise_instruction summary: F1=0.165, EM=0.050
[04:56:20] 
üîÑ Testing template: context_emphasis
[04:56:20] Generating answer for template: context_emphasis
[04:56:20] Using prompt: Based on the relevant context, answer: In what country is Normandy located?
[04:56:20] Input prepared: torch.Size([1, 17])
[04:56:20] RAG generated: ' france' for context_emphasis
[04:56:20] Generating answer for template: context_emphasis
[04:56:20] Using prompt: Based on the relevant context, answer: When were the Normans in Normandy?
[04:56:20] Input prepared: torch.Size([1, 18])
[04:56:21] RAG generated: ' 10th century -- 15th century' for context_emphasis
[04:56:21] Generating answer for template: context_emphasis
[04:56:21] Using prompt: Based on the relevant context, answer: From which countries did the Norse originate?
[04:56:21] Input prepared: torch.Size([1, 18])
[04:56:21] RAG generated: ' scandinavia' for context_emphasis
[04:56:21] Generating answer for template: context_emphasis
[04:56:21] Using prompt: Based on the relevant context, answer: Who was the Norse leader?
[04:56:21] Input prepared: torch.Size([1, 16])
[04:56:21] RAG generated: ' who was / was not' for context_emphasis
[04:56:21] Generating answer for template: context_emphasis
[04:56:21] Using prompt: Based on the relevant context, answer: What century did the Normans first gain their separate identity?
[04:56:21] Input prepared: torch.Size([1, 22])
[04:56:21] RAG generated: ' the 10th century' for context_emphasis
[04:56:21]   Progress: 65/140 (46.4%)
[04:56:21] Generating answer for template: context_emphasis
[04:56:21] Using prompt: Based on the relevant context, answer: Who was the duke in the battle of Hastings?
[04:56:21] Input prepared: torch.Size([1, 20])
[04:56:21] RAG generated: ' normandy duke of normandy' for context_emphasis
[04:56:21] Generating answer for template: context_emphasis
[04:56:21] Using prompt: Based on the relevant context, answer: Who ruled the duchy of Normandy
[04:56:21] Input prepared: torch.Size([1, 16])
[04:56:21] RAG generated: ' king charles iii of west francia' for context_emphasis
[04:56:21] Generating answer for template: context_emphasis
[04:56:21] Using prompt: Based on the relevant context, answer: What religion were the Normans
[04:56:21] Input prepared: torch.Size([1, 16])
[04:56:22] RAG generated: ' catholicism' for context_emphasis
[04:56:22] Generating answer for template: context_emphasis
[04:56:22] Using prompt: Based on the relevant context, answer: What is the original meaning of the word Norman?
[04:56:22] Input prepared: torch.Size([1, 20])
[04:56:22] RAG generated: ' norman' for context_emphasis
[04:56:22] Generating answer for template: context_emphasis
[04:56:22] Using prompt: Based on the relevant context, answer: When was the Latin version of the word Norman first recorded?
[04:56:22] Input prepared: torch.Size([1, 22])
[04:56:22] RAG generated: ' in 1024' for context_emphasis
[04:56:22]   Progress: 70/140 (50.0%)
[04:56:22] Generating answer for template: context_emphasis
[04:56:22] Using prompt: Based on the relevant context, answer: When was the Duchy of Normandy founded?
[04:56:22] Input prepared: torch.Size([1, 18])
[04:56:22] RAG generated: ' 1066' for context_emphasis
[04:56:22] Generating answer for template: context_emphasis
[04:56:22] Using prompt: Based on the relevant context, answer: Who did Rollo sign the treaty of Saint-Clair-sur-Epte with?
[04:56:22] Input prepared: torch.Size([1, 28])
[04:56:22] RAG generated: ' charles the simple' for context_emphasis
[04:56:22] Generating answer for template: context_emphasis
[04:56:22] Using prompt: Based on the relevant context, answer: What river originally bounded the Duchy
[04:56:22] Input prepared: torch.Size([1, 16])
[04:56:22] RAG generated: ' tennessee river' for context_emphasis
[04:56:22] Generating answer for template: context_emphasis
[04:56:22] Using prompt: Based on the relevant context, answer: Who upon arriving gave the original viking settlers a common identity?
[04:56:22] Input prepared: torch.Size([1, 22])
[04:56:23] RAG generated: ' the Normans' for context_emphasis
[04:56:23] Generating answer for template: context_emphasis
[04:56:23] Using prompt: Based on the relevant context, answer: What was the Norman religion?
[04:56:23] Input prepared: torch.Size([1, 16])
[04:56:23] RAG generated: ' islam' for context_emphasis
[04:56:23]   Progress: 75/140 (53.6%)
[04:56:23] Generating answer for template: context_emphasis
[04:56:23] Using prompt: Based on the relevant context, answer: What part of France were the Normans located?
[04:56:23] Input prepared: torch.Size([1, 20])
[04:56:23] RAG generated: ' normandy' for context_emphasis
[04:56:23] Generating answer for template: context_emphasis
[04:56:23] Using prompt: Based on the relevant context, answer: What was one of the Norman's major exports?
[04:56:23] Input prepared: torch.Size([1, 21])
[04:56:23] RAG generated: ' foodstuffs' for context_emphasis
[04:56:23] Generating answer for template: context_emphasis
[04:56:23] Using prompt: Based on the relevant context, answer: Who was the Normans' main enemy in Italy, the Byzantine Empire and Armenia?
[04:56:23] Input prepared: torch.Size([1, 27])
[04:56:23] RAG generated: ' the pechenegs' for context_emphasis
[04:56:23] Generating answer for template: context_emphasis
[04:56:23] Using prompt: Based on the relevant context, answer: When did Herve serve as a Byzantine general?
[04:56:23] Input prepared: torch.Size([1, 20])
[04:56:23] RAG generated: ' 552 -- 553' for context_emphasis
[04:56:23] Generating answer for template: context_emphasis
[04:56:23] Using prompt: Based on the relevant context, answer: When did Robert Crispin go up against the Turks?
[04:56:23] Input prepared: torch.Size([1, 21])
[04:56:23] RAG generated: ' 2018' for context_emphasis
[04:56:23]   Progress: 80/140 (57.1%)
[04:56:23]    context_emphasis summary: F1=0.119, EM=0.050
[04:56:23] 
üîÑ Testing template: basic
[04:56:23] Generating answer for template: basic
[04:56:23] Using prompt: In what country is Normandy located?
[04:56:23] Input prepared: torch.Size([1, 9])
[04:56:24] RAG generated: ' france' for basic
[04:56:24] Generating answer for template: basic
[04:56:24] Using prompt: When were the Normans in Normandy?
[04:56:24] Input prepared: torch.Size([1, 10])
[04:56:24] RAG generated: ' 9th century -- 9th century' for basic
[04:56:24] Generating answer for template: basic
[04:56:24] Using prompt: From which countries did the Norse originate?
[04:56:24] Input prepared: torch.Size([1, 10])
[04:56:24] RAG generated: ' sweden' for basic
[04:56:24] Generating answer for template: basic
[04:56:24] Using prompt: Who was the Norse leader?
[04:56:24] Input prepared: torch.Size([1, 8])
[04:56:24] RAG generated: ' cnut' for basic
[04:56:24] Generating answer for template: basic
[04:56:24] Using prompt: What century did the Normans first gain their separate identity?
[04:56:24] Input prepared: torch.Size([1, 14])
[04:56:24] RAG generated: ' the ninth century' for basic
[04:56:24]   Progress: 85/140 (60.7%)
[04:56:24] Generating answer for template: basic
[04:56:24] Using prompt: Who was the duke in the battle of Hastings?
[04:56:24] Input prepared: torch.Size([1, 12])
[04:56:24] RAG generated: ' william' for basic
[04:56:24] Generating answer for template: basic
[04:56:24] Using prompt: Who ruled the duchy of Normandy
[04:56:24] Input prepared: torch.Size([1, 8])
[04:56:25] RAG generated: ' king charles iii of west francia' for basic
[04:56:25] Generating answer for template: basic
[04:56:25] Using prompt: What religion were the Normans
[04:56:25] Input prepared: torch.Size([1, 8])
[04:56:25] RAG generated: ' catholicism' for basic
[04:56:25] Generating answer for template: basic
[04:56:25] Using prompt: What is the original meaning of the word Norman?
[04:56:25] Input prepared: torch.Size([1, 12])
[04:56:25] RAG generated: ' north' for basic
[04:56:25] Generating answer for template: basic
[04:56:25] Using prompt: When was the Latin version of the word Norman first recorded?
[04:56:25] Input prepared: torch.Size([1, 14])
[04:56:25] RAG generated: ' 1024' for basic
[04:56:25]   Progress: 90/140 (64.3%)
[04:56:25] Generating answer for template: basic
[04:56:25] Using prompt: When was the Duchy of Normandy founded?
[04:56:25] Input prepared: torch.Size([1, 10])
[04:56:25] RAG generated: ' 1066' for basic
[04:56:25] Generating answer for template: basic
[04:56:25] Using prompt: Who did Rollo sign the treaty of Saint-Clair-sur-Epte with?
[04:56:25] Input prepared: torch.Size([1, 20])
[04:56:25] RAG generated: ' charles the simple' for basic
[04:56:25] Generating answer for template: basic
[04:56:25] Using prompt: What river originally bounded the Duchy
[04:56:25] Input prepared: torch.Size([1, 8])
[04:56:25] RAG generated: ' elbe' for basic
[04:56:25] Generating answer for template: basic
[04:56:25] Using prompt: Who upon arriving gave the original viking settlers a common identity?
[04:56:25] Input prepared: torch.Size([1, 14])
[04:56:26] RAG generated: ' the byzantines' for basic
[04:56:26] Generating answer for template: basic
[04:56:26] Using prompt: What was the Norman religion?
[04:56:26] Input prepared: torch.Size([1, 8])
[04:56:26] RAG generated: ' catholicism' for basic
[04:56:26]   Progress: 95/140 (67.9%)
[04:56:26] Generating answer for template: basic
[04:56:26] Using prompt: What part of France were the Normans located?
[04:56:26] Input prepared: torch.Size([1, 12])
[04:56:26] RAG generated: ' west france' for basic
[04:56:26] Generating answer for template: basic
[04:56:26] Using prompt: What was one of the Norman's major exports?
[04:56:26] Input prepared: torch.Size([1, 13])
[04:56:26] RAG generated: ' cloth' for basic
[04:56:26] Generating answer for template: basic
[04:56:26] Using prompt: Who was the Normans' main enemy in Italy, the Byzantine Empire and Armenia?
[04:56:26] Input prepared: torch.Size([1, 19])
[04:56:26] RAG generated: ' hohenstaufen' for basic
[04:56:26] Generating answer for template: basic
[04:56:26] Using prompt: When did Herve serve as a Byzantine general?
[04:56:26] Input prepared: torch.Size([1, 12])
[04:56:26] RAG generated: ' 1984 -- 86' for basic
[04:56:26] Generating answer for template: basic
[04:56:26] Using prompt: When did Robert Crispin go up against the Turks?
[04:56:26] Input prepared: torch.Size([1, 13])
[04:56:27] RAG generated: ' 862' for basic
[04:56:27]   Progress: 100/140 (71.4%)
[04:56:27]    basic summary: F1=0.162, EM=0.100
[04:56:27] 
üîÑ Testing template: knowledge_based
[04:56:27] Generating answer for template: knowledge_based
[04:56:27] Using prompt: Using available knowledge, answer: In what country is Normandy located?
[04:56:27] Input prepared: torch.Size([1, 15])
[04:56:27] RAG generated: ' france' for knowledge_based
[04:56:27] Generating answer for template: knowledge_based
[04:56:27] Using prompt: Using available knowledge, answer: When were the Normans in Normandy?
[04:56:27] Input prepared: torch.Size([1, 16])
[04:56:27] RAG generated: ' 10th century -- 15th century' for knowledge_based
[04:56:27] Generating answer for template: knowledge_based
[04:56:27] Using prompt: Using available knowledge, answer: From which countries did the Norse originate?
[04:56:27] Input prepared: torch.Size([1, 16])
[04:56:27] RAG generated: ' scandinavia' for knowledge_based
[04:56:27] Generating answer for template: knowledge_based
[04:56:27] Using prompt: Using available knowledge, answer: Who was the Norse leader?
[04:56:27] Input prepared: torch.Size([1, 14])
[04:56:27] RAG generated: ' problem : who was the norse leader' for knowledge_based
[04:56:27] Generating answer for template: knowledge_based
[04:56:27] Using prompt: Using available knowledge, answer: What century did the Normans first gain their separate identity?
[04:56:27] Input prepared: torch.Size([1, 20])
[04:56:27] RAG generated: ' the early 16th century' for knowledge_based
[04:56:27]   Progress: 105/140 (75.0%)
[04:56:27] Generating answer for template: knowledge_based
[04:56:27] Using prompt: Using available knowledge, answer: Who was the duke in the battle of Hastings?
[04:56:27] Input prepared: torch.Size([1, 18])
[04:56:27] RAG generated: ' normandy duke of normandy' for knowledge_based
[04:56:27] Generating answer for template: knowledge_based
[04:56:27] Using prompt: Using available knowledge, answer: Who ruled the duchy of Normandy
[04:56:27] Input prepared: torch.Size([1, 14])
[04:56:28] RAG generated: ' king charles iii' for knowledge_based
[04:56:28] Generating answer for template: knowledge_based
[04:56:28] Using prompt: Using available knowledge, answer: What religion were the Normans
[04:56:28] Input prepared: torch.Size([1, 14])
[04:56:28] RAG generated: ' islam' for knowledge_based
[04:56:28] Generating answer for template: knowledge_based
[04:56:28] Using prompt: Using available knowledge, answer: What is the original meaning of the word Norman?
[04:56:28] Input prepared: torch.Size([1, 18])
[04:56:28] RAG generated: ' norman' for knowledge_based
[04:56:28] Generating answer for template: knowledge_based
[04:56:28] Using prompt: Using available knowledge, answer: When was the Latin version of the word Norman first recorded?
[04:56:28] Input prepared: torch.Size([1, 20])
[04:56:28] RAG generated: ' sometime before 1982' for knowledge_based
[04:56:28]   Progress: 110/140 (78.6%)
[04:56:28] Generating answer for template: knowledge_based
[04:56:28] Using prompt: Using available knowledge, answer: When was the Duchy of Normandy founded?
[04:56:28] Input prepared: torch.Size([1, 16])
[04:56:28] RAG generated: ' 1066' for knowledge_based
[04:56:28] Generating answer for template: knowledge_based
[04:56:28] Using prompt: Using available knowledge, answer: Who did Rollo sign the treaty of Saint-Clair-sur-Epte with?
[04:56:28] Input prepared: torch.Size([1, 26])
[04:56:29] RAG generated: ' b·∫£o ƒë·∫°i' for knowledge_based
[04:56:29] Generating answer for template: knowledge_based
[04:56:29] Using prompt: Using available knowledge, answer: What river originally bounded the Duchy
[04:56:29] Input prepared: torch.Size([1, 14])
[04:56:29] RAG generated: ' rhode island' for knowledge_based
[04:56:29] Generating answer for template: knowledge_based
[04:56:29] Using prompt: Using available knowledge, answer: Who upon arriving gave the original viking settlers a common identity?
[04:56:29] Input prepared: torch.Size([1, 20])
[04:56:29] RAG generated: ' the Peaks' for knowledge_based
[04:56:29] Generating answer for template: knowledge_based
[04:56:29] Using prompt: Using available knowledge, answer: What was the Norman religion?
[04:56:29] Input prepared: torch.Size([1, 14])
[04:56:29] RAG generated: ' islam' for knowledge_based
[04:56:29]   Progress: 115/140 (82.1%)
[04:56:29] Generating answer for template: knowledge_based
[04:56:29] Using prompt: Using available knowledge, answer: What part of France were the Normans located?
[04:56:29] Input prepared: torch.Size([1, 18])
[04:56:29] RAG generated: ' normandy' for knowledge_based
[04:56:29] Generating answer for template: knowledge_based
[04:56:29] Using prompt: Using available knowledge, answer: What was one of the Norman's major exports?
[04:56:29] Input prepared: torch.Size([1, 19])
[04:56:29] RAG generated: ' cloth' for knowledge_based
[04:56:29] Generating answer for template: knowledge_based
[04:56:29] Using prompt: Using available knowledge, answer: Who was the Normans' main enemy in Italy, the Byzantine Empire and Armenia?
[04:56:29] Input prepared: torch.Size([1, 25])
[04:56:30] RAG generated: ' the byzantine empire' for knowledge_based
[04:56:30] Generating answer for template: knowledge_based
[04:56:30] Using prompt: Using available knowledge, answer: When did Herve serve as a Byzantine general?
[04:56:30] Input prepared: torch.Size([1, 18])
[04:56:30] RAG generated: ' 1984 -- 86' for knowledge_based
[04:56:30] Generating answer for template: knowledge_based
[04:56:30] Using prompt: Using available knowledge, answer: When did Robert Crispin go up against the Turks?
[04:56:30] Input prepared: torch.Size([1, 19])
[04:56:30] RAG generated: ' robert crispin and the turks' for knowledge_based
[04:56:30]   Progress: 120/140 (85.7%)
[04:56:30]    knowledge_based summary: F1=0.079, EM=0.050
[04:56:30] 
üîÑ Testing template: confident
[04:56:30] Generating answer for template: confident
[04:56:30] Using prompt: Provide a confident, accurate answer: In what country is Normandy located?
[04:56:30] Input prepared: torch.Size([1, 16])
[04:56:30] RAG generated: ' france' for confident
[04:56:30] Generating answer for template: confident
[04:56:30] Using prompt: Provide a confident, accurate answer: When were the Normans in Normandy?
[04:56:30] Input prepared: torch.Size([1, 17])
[04:56:30] RAG generated: ' 3rd century -- 17th century' for confident
[04:56:30] Generating answer for template: confident
[04:56:30] Using prompt: Provide a confident, accurate answer: From which countries did the Norse originate?
[04:56:30] Input prepared: torch.Size([1, 17])
[04:56:30] RAG generated: ' norway' for confident
[04:56:30] Generating answer for template: confident
[04:56:30] Using prompt: Provide a confident, accurate answer: Who was the Norse leader?
[04:56:30] Input prepared: torch.Size([1, 15])
[04:56:31] RAG generated: ' norse' for confident
[04:56:31] Generating answer for template: confident
[04:56:31] Using prompt: Provide a confident, accurate answer: What century did the Normans first gain their separate identity?
[04:56:31] Input prepared: torch.Size([1, 21])
[04:56:31] RAG generated: ' the ninth century' for confident
[04:56:31]   Progress: 125/140 (89.3%)
[04:56:31] Generating answer for template: confident
[04:56:31] Using prompt: Provide a confident, accurate answer: Who was the duke in the battle of Hastings?
[04:56:31] Input prepared: torch.Size([1, 19])
[04:56:31] RAG generated: ' norman' for confident
[04:56:31] Generating answer for template: confident
[04:56:31] Using prompt: Provide a confident, accurate answer: Who ruled the duchy of Normandy
[04:56:31] Input prepared: torch.Size([1, 15])
[04:56:31] RAG generated: ' charles - charles' for confident
[04:56:31] Generating answer for template: confident
[04:56:31] Using prompt: Provide a confident, accurate answer: What religion were the Normans
[04:56:31] Input prepared: torch.Size([1, 15])
[04:56:31] RAG generated: ' normanism' for confident
[04:56:31] Generating answer for template: confident
[04:56:31] Using prompt: Provide a confident, accurate answer: What is the original meaning of the word Norman?
[04:56:31] Input prepared: torch.Size([1, 19])
[04:56:31] RAG generated: ' norman' for confident
[04:56:31] Generating answer for template: confident
[04:56:31] Using prompt: Provide a confident, accurate answer: When was the Latin version of the word Norman first recorded?
[04:56:31] Input prepared: torch.Size([1, 21])
[04:56:31] RAG generated: ' the late eighth century' for confident
[04:56:31]   Progress: 130/140 (92.9%)
[04:56:31] Generating answer for template: confident
[04:56:31] Using prompt: Provide a confident, accurate answer: When was the Duchy of Normandy founded?
[04:56:31] Input prepared: torch.Size([1, 17])
[04:56:32] RAG generated: ' 1066' for confident
[04:56:32] Generating answer for template: confident
[04:56:32] Using prompt: Provide a confident, accurate answer: Who did Rollo sign the treaty of Saint-Clair-sur-Epte with?
[04:56:32] Input prepared: torch.Size([1, 27])
[04:56:32] RAG generated: ' the franks' for confident
[04:56:32] Generating answer for template: confident
[04:56:32] Using prompt: Provide a confident, accurate answer: What river originally bounded the Duchy
[04:56:32] Input prepared: torch.Size([1, 15])
[04:56:32] RAG generated: ' high falls' for confident
[04:56:32] Generating answer for template: confident
[04:56:32] Using prompt: Provide a confident, accurate answer: Who upon arriving gave the original viking settlers a common identity?
[04:56:32] Input prepared: torch.Size([1, 21])
[04:56:32] RAG generated: '' for confident
[04:56:32] Generating answer for template: confident
[04:56:32] Using prompt: Provide a confident, accurate answer: What was the Norman religion?
[04:56:32] Input prepared: torch.Size([1, 15])
[04:56:32] RAG generated: ' islam' for confident
[04:56:32]   Progress: 135/140 (96.4%)
[04:56:32] Generating answer for template: confident
[04:56:32] Using prompt: Provide a confident, accurate answer: What part of France were the Normans located?
[04:56:32] Input prepared: torch.Size([1, 19])
[04:56:32] RAG generated: ' western france' for confident
[04:56:32] Generating answer for template: confident
[04:56:32] Using prompt: Provide a confident, accurate answer: What was one of the Norman's major exports?
[04:56:32] Input prepared: torch.Size([1, 20])
[04:56:33] RAG generated: ' 266,827' for confident
[04:56:33] Generating answer for template: confident
[04:56:33] Using prompt: Provide a confident, accurate answer: Who was the Normans' main enemy in Italy, the Byzantine Empire and Armenia?
[04:56:33] Input prepared: torch.Size([1, 26])
[04:56:33] RAG generated: '' for confident
[04:56:33] Generating answer for template: confident
[04:56:33] Using prompt: Provide a confident, accurate answer: When did Herve serve as a Byzantine general?
[04:56:33] Input prepared: torch.Size([1, 19])
[04:56:33] RAG generated: ' 2004 -- 05' for confident
[04:56:33] Generating answer for template: confident
[04:56:33] Using prompt: Provide a confident, accurate answer: When did Robert Crispin go up against the Turks?
[04:56:33] Input prepared: torch.Size([1, 20])
[04:56:33] RAG generated: ' the battle of od≈æak' for confident
[04:56:33]   Progress: 140/140 (100.0%)
[04:56:33]    confident summary: F1=0.107, EM=0.050
[04:56:33] 
üéâ Experiment completed!
[04:56:33]  Total results generated: 140
[04:56:33] 
 ANALYZING RESULTS...
[04:56:33] 
üèÜ TEMPLATE PERFORMANCE RANKING:
[04:56:33] --------------------------------------------------------------------------------
[04:56:33] Template             F1 Score   EM Score   Overlap    Length  
[04:56:33] --------------------------------------------------------------------------------
[04:56:33] precise_instruction  0.165     0.050     0.179     2.1
[04:56:33] basic                0.162     0.100     0.158     1.9
[04:56:33] instructional        0.119     0.050     0.125     2.2
[04:56:33] context_emphasis     0.119     0.050     0.129     2.3
[04:56:33] confident            0.107     0.050     0.113     1.9
[04:56:33] knowledge_based      0.079     0.050     0.087     2.5
[04:56:33] expert_role          0.070     0.050     0.062     1.9
[04:56:33] 
 STATISTICAL ANALYSIS:
[04:56:33]   ü•á Best Template: precise_instruction (F1: 0.165)
[04:56:33]   ü•â Worst Template: expert_role (F1: 0.070)
[04:56:33]    Performance Improvement: 135.7%
[04:56:33]   üìè F1 Score Range: 0.070 - 0.165
[04:56:33]   üåü Using REAL Wikipedia embeddings
[04:56:33]   ‚ö†Ô∏è  Performance lower than expected with real data
[04:56:33] 
 Saving results...
[04:56:33]    Detailed results: ../results/detailed_results_20250705_045633.csv
[04:56:33]    Summary: ../results/summary_20250705_045633.csv
[04:56:33]   üìÑ Report: ../results/report_20250705_045633.md
[04:56:33]   üîß Metadata: ../results/metadata_20250705_045633.json
[04:56:33] 
üìã SAMPLE RESULTS:
[04:56:33] ======================================================================
[04:56:33] 
üî∏ Example 1 (Template: precise_instruction):
[04:56:33]    Q: In what country is Normandy located?
[04:56:33]    Expected: France
[04:56:33]    Generated: france
[04:56:33]    F1: 1.000, EM: 1.0
[04:56:33] 
üî∏ Example 2 (Template: precise_instruction):
[04:56:33]    Q: When were the Normans in Normandy?
[04:56:33]    Expected: 10th and 11th centuries
[04:56:33]    Generated: between the 10th and 13th centuries
[04:56:33]    F1: 0.600, EM: 0.0
[04:56:33] 
üî∏ Example 3 (Template: precise_instruction):
[04:56:33]    Q: From which countries did the Norse originate?
[04:56:33]    Expected: Denmark, Iceland and Norway
[04:56:33]    Generated: scandinavia
[04:56:33]    F1: 0.000, EM: 0.0
[04:56:33] 
üéâ EXPERIMENT COMPLETED SUCCESSFULLY!
[04:56:33]  Check the results directory for detailed outputs
